"use strict";(self.webpackChunkrs_chat=self.webpackChunkrs_chat||[]).push([[369],{369:(e,s,l)=>{l.r(s),l.d(s,{default:()=>ce});const t="style_main__6bTqx";var a=l(791),n=l(434),r=l(810),i=l(476),c=l(644);const o="style_header__wSxZO",d="style_content-wrapper__LV023";var u=l(209),_=l(689),h=l(36),m=l(184);const g=()=>{const e=(0,n.v9)((e=>e.users.userCurrent)),s=(0,_.s0)(),l={pending:()=>{},fullfilled:()=>{u.h.dispatch((0,h.kS)(e)),s("/login")},rejected:()=>{}},[t,a,g]=(0,i.T)(e,r.EJ.LOGOUT,l);return(0,m.jsxs)("section",{className:o,children:[(0,m.jsxs)("article",{className:d,children:[(0,m.jsx)("label",{children:"".concat("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: ").concat(e.login)}),(0,m.jsx)("label",{children:"\u0412\u0435\u0441\u0435\u043b\u044b\u0439 \u0447\u0430\u0442\u0438\u043a"})]}),(0,m.jsx)(c.Z,{text:"\u0418\u043d\u0444\u043e",callback:()=>s("/about"),small:!0}),(0,m.jsx)(c.Z,{text:"\u0412\u044b\u0445\u043e\u0434",callback:a,small:!0})]})},v="style_footer__XpOM9",x=()=>(0,m.jsxs)("section",{className:v,children:[(0,m.jsx)("label",{children:"RSSchool"}),(0,m.jsx)("label",{children:"MikAleinik"}),(0,m.jsx)("label",{children:"2023"})]}),f="style_contacts__ixJ0h",j="style_search__BM5Iv";var b=l(101);const y="style_user-contact-container__9K3Dv",E="style_user-status__FoXh9",S="style_active__3eOEG",p="style_user-login__hDLof",N="style_user-messages__CWGYl",k=e=>{let{login:s,active:l,messages:t=0}=e;return(0,m.jsxs)("li",{className:y,onClick:()=>{let e=u.h.getState().users.usersAnother.active.filter((e=>e.login===s));1===e.length?(u.h.dispatch((0,h.dy)(e[0])),u.h.dispatch((0,b.VV)())):(e=u.h.getState().users.usersAnother.inactive.filter((e=>e.login===s)),u.h.dispatch((0,h.dy)(e[0])),u.h.dispatch((0,b.VV)()))},children:[(0,m.jsx)("div",{className:l?"".concat(E," ").concat(S):E}),(0,m.jsx)("label",{className:p,children:s}),0!==t&&(0,m.jsx)("label",{className:N,children:t})]})},C="style_user-list__SKh7i",L=(e,s)=>{let l=0;return s.forEach((s=>{s.login===e&&Array.isArray(s.messages)&&s.messages.forEach((s=>{s.from===e&&!1===s.status.isReaded&&(l+=1)}))})),l},w=e=>{let{search:s}=e;const l=(0,n.v9)((e=>e.users.userCurrent.login)),t=(0,n.v9)((e=>e.users.usersAnother.active)),a=(0,n.v9)((e=>e.users.usersAnother.inactive)),r=(0,n.v9)((e=>e.dialogs.messages));return(0,m.jsxs)("ul",{className:C,children:[null===t||void 0===t?void 0:t.map(((e,t)=>{var a;return e.login!==l&&-1!==(null===(a=e.login)||void 0===a?void 0:a.indexOf(s))&&(0,m.jsx)(k,{login:e.login||"",active:!0,messages:L(e.login||"",r)},t)})),null===a||void 0===a?void 0:a.map(((e,l)=>{var t;return-1!==(null===(t=e.login)||void 0===t?void 0:t.indexOf(s))&&(0,m.jsx)(k,{login:e.login||"",active:!1,messages:L(e.login||"",r)},l)}))]})},T=()=>{const[e,s]=(0,a.useState)("");return(0,m.jsxs)("aside",{className:f,children:[(0,m.jsx)("input",{className:j,placeholder:"\u041f\u043e\u0438\u0441\u043a...",onKeyUp:e=>{s(e.currentTarget.value)}}),(0,m.jsx)(w,{search:e})]})},V="style_dialog-content__4n1XG",D="style_info__EVLJb",R="style_history-delimier__uPrWv",A="style_delimier-text__t27Eq",M="style_message-container__YZ+2Y",G="style_current__aKjFe",X="style_another__mL3sp",I="style_message__C24Vo",O="style_header__wSY6R",Z="style_text__E3jm+",K="style_footer__zvIdN",q=e=>{let{message:s,innerRef:l,menuCallback:t}=e;const a=(0,n.v9)((e=>e.users.userCurrent.login)),r=e=>{"function"===typeof t&&a===s.from?t(e,s.id||""):e.preventDefault()};return(0,m.jsx)("div",{ref:l,className:a===s.from?"".concat(M," ").concat(G):"".concat(M," ").concat(X),onContextMenu:r,onTouchEnd:r,children:(0,m.jsxs)("div",{className:I,children:[(0,m.jsxs)("div",{className:O,children:[(0,m.jsx)("label",{children:s.from===a?"\u0432\u044b":s.from}),(0,m.jsx)("label",{children:new Date(s.datetime).toLocaleString()})]}),(0,m.jsx)("div",{className:Z,children:s.text}),(0,m.jsxs)("div",{className:K,children:[(0,m.jsx)("label",{children:s.status.isEdited?"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u043e":""}),(0,m.jsx)("label",{children:a===s.from&&(i=s.status.isDelivered,c=s.status.isReaded,c?"\u041f\u0440\u043e\u0447\u0438\u0442\u0430\u043d\u043e".toLowerCase():i?"\u0414\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e".toLowerCase():"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e".toLowerCase())})]})]})});var i,c};var W=l(83);const Y=()=>{const e=u.h.getState(),s=e.dialogs.messages.filter((s=>s.login===e.users.userSelected.login))[0];s&&s.messages.forEach((s=>{if(!s.status.isReaded&&s.from!==e.users.userCurrent.login){const e={message:{id:s.id}};(0,W.b)(r.kX.MSG_READED,e)}}))},F="style_context-menu__q46CW",J="style_context-menu_item__teCHt",U=e=>{var s;let{event:l,id:t,items:a}=e;l.preventDefault();const n={top:(null===(s=l.nativeEvent.target.parentElement)||void 0===s?void 0:s.offsetTop)||0};return(0,m.jsx)("ul",{className:F,style:n,children:a.map(((e,s)=>(0,m.jsx)("li",{className:J,onClick:e.callback.bind(void 0,t),children:e.name},s)))})},H=(e,s,l,t)=>0===t&&l.from===s||l.from!==s?e:void 0,P=()=>{const e=(0,n.v9)((e=>e.users.userSelected.login)),s=(0,n.v9)((e=>e.dialogs.messages)),[l,t]=(0,a.useState)(new Array),[i,c]=(0,a.useState)(new Array),[o,d]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const l=((e,s)=>{const l=[];return s.forEach((s=>{s.login===e&&l.push(...s.messages)})),l})(e,s),a=l.filter((e=>!1!==e.status.isReaded)),n=l.filter((e=>!1===e.status.isReaded));t(a),c(n),n.length>0&&n[0].from===e?d(!0):d(!1)}),[s,e]);const _=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(null);(0,a.useEffect)((()=>{var e;if(o)null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"});else if(i.length>0){var s;null===(s=_.current)||void 0===s||s.scrollIntoView({behavior:"smooth"})}else{var l;null===(l=h.current)||void 0===l||l.scrollIntoView({behavior:"smooth"})}}),[o,g,_,h,i,l]);const[v,x]=(0,a.useState)(null),f=(e,s)=>{if(s===r.kX.MSG_DELETE){const s={message:{id:e}};(0,W.b)(r.kX.MSG_DELETE,s)}s===r.kX.SELECT_MESSAGE&&u.h.dispatch((0,b.rT)(e)),x(null)},j=[{name:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",callback:e=>f.bind(void 0,e,r.kX.SELECT_MESSAGE)()},{name:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",callback:e=>f.bind(void 0,e,r.kX.MSG_DELETE)()}],y=(e,s)=>{const l={event:e,id:s,items:j};e.currentTarget.scrollIntoView({behavior:"smooth",block:"end"}),x(l)};return(0,a.useEffect)((()=>{document.addEventListener("click",(()=>x(null)))})),(0,m.jsxs)("article",{className:V,onClick:Y,onWheel:Y,ref:g,children:[null===e&&(0,m.jsx)("label",{className:D,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f..."}),null!==e&&0===l.length&&0===i.length&&(0,m.jsx)("label",{className:D,children:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u043f\u0435\u0440\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."}),l.map((e=>(0,m.jsx)(q,{message:e,innerRef:h,menuCallback:y},e.id))),o&&(0,m.jsx)("div",{className:R,ref:g,children:(0,m.jsx)("label",{className:A,children:"\u041d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"})}),i.map(((s,l)=>(0,m.jsx)(q,{message:s,innerRef:H(_,e,s,l),menuCallback:y},s.id))),null!==v&&(0,m.jsx)(U,{...v})]})},Q="style_dialog-header__65E3e",z="style_user-active__UVNgM",B="style_user-inactive__EIH8x",$=()=>{const e=(0,n.v9)((e=>e.users.usersAnother.active)),s=(0,n.v9)((e=>e.users.userSelected.login)),[l,t]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{if(e){const l=e.some((e=>e.login===s));t(l)}}),[e,s]),(0,m.jsxs)("article",{className:Q,children:[(0,m.jsx)("label",{children:s}),s&&(0,m.jsx)("label",{className:l?z:B,children:l?"\u0432 \u0441\u0435\u0442\u0438":"\u043d\u0435 \u0432 \u0441\u0435\u0442\u0438"})]})},ee="style_dialog-input__hZtqN",se="style_dialog-input-field__ElLFn",le="style_dialog-input-cancel__cybnP",te=()=>{const e=(0,n.v9)((e=>e.users.userSelected.login)),s=(0,n.v9)((e=>e.dialogs.messageSelected));(0,a.useEffect)((()=>{u.h.getState().dialogs.messages.forEach((e=>{const l=e.messages.filter((e=>e.id===s));1===l.length&&t(l[0].text)}))}),[s]);const[l,t]=(0,a.useState)(""),i=()=>{if(""!==l){if(null===s){const s={message:{to:e,text:l}};(0,W.b)(r.kX.MSG_SEND,s)}else{const e={message:{id:s,text:l}};(0,W.b)(r.kX.MSG_EDIT,e)}o(),t(""),Y()}},o=()=>{u.h.dispatch((0,b.VV)()),t("")};return(0,m.jsxs)("form",{className:ee,onSubmit:e=>{e.preventDefault(),i()},children:[(0,m.jsx)("input",{value:l,className:se,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",onChange:e=>{t(e.currentTarget.value)},disabled:null===e}),null!==s&&(0,m.jsx)("label",{className:le,onClick:o,children:"X"}),(0,m.jsx)(c.Z,{text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",callback:i,small:!0,disabled:null===e||""===l})]})},ae="style_dialog-container__7eQ5Q",ne=()=>(0,m.jsxs)("article",{className:ae,children:[(0,m.jsx)($,{}),(0,m.jsx)(P,{}),(0,m.jsx)(te,{})]}),re="style_content__8VK4k",ie=()=>(0,m.jsxs)("section",{className:re,children:[(0,m.jsx)(T,{}),(0,m.jsx)(ne,{})]}),ce=()=>(0,m.jsxs)("main",{className:t,children:[(0,m.jsx)(g,{}),(0,m.jsx)(ie,{}),(0,m.jsx)(x,{})]})}}]);
//# sourceMappingURL=369.70d3dbba.chunk.js.map